{"author":{"id":"3b5d56db7b4c505b0b351442626ce2665e71435894ed5930cbc7373521d14d25"},"ops":[{"type":1,"timestamp":1578399207,"nonce":"Bm4TAkkCrDkMg4xukwoZytzCV60=","metadata":{"github-id":"MDU6SXNzdWU1NDYyNTA4ODk=","github-url":"https://github.com/git-bug/git-bug/issues/289","origin":"github"},"title":"Multiple repositories with same bridge/token","message":"It does not seem to be possible to have two bridges using a common token with the same target:\n\nThe following was performed within a clean environment:\n\n1. Initial clone of one repository (I've edited out my token), everything works as expected:\n```bash\n[eve@computer test]$ git clone https://github.com/MichaelMure/git-bug\nCloning into 'git-bug'...\nremote: Enumerating objects: 85, done.\nremote: Counting objects: 100% (85/85), done.\nremote: Compressing objects: 100% (64/64), done.\nremote: Total 11128 (delta 35), reused 41 (delta 20), pack-reused 11043\nReceiving objects: 100% (11128/11128), 15.75 MiB | 13.19 MiB/s, done.\nResolving deltas: 100% (6415/6415), done.\n[eve@computer test]$ cd git-bug\n[eve@computer git-bug]$ git bug user create\nBuilding identity cache... Done.\nBuilding bug cache... Done.\nError: Error running git command: config user.name\n[eve@computer git-bug]$ git config user.name \"eve\"\n[eve@computer git-bug]$ git config user.email \"eve@example.org\"\n[eve@computer git-bug]$ git bug user create\nName [eve]: \nEmail [eve@example.org]: \nAvatar URL: \n\na66bcfdac7e2687ddb9310fc27bd011a5b8e334d\n[eve@computer git-bug]$ git bug bridge configure --name=github --target=github --token=$MYTOKEN --url=https://github.com/MichaelMure/git-bug\nSuccessfully configured bridge: github\n[eve@computer git-bug]$ git bug bridge pull github\nnew identity: 85871c63bc6b96359ec6ab4db876bba950ddd2a8\n...\nchanged status: 1ee55b4f149e87fbc80d1ddefb43666e33f12381748044dd8c195d305d12b9b5\nimported 120 issues and 81 identities with github bridge\n```\n\n2. Clone of another repository\n\n```bash\n[eve@computer test]$ git clone https://github.com/MichaelMure/go-term-text\nCloning into 'go-term-text'...\nremote: Enumerating objects: 263, done.\nremote: Counting objects: 100% (263/263), done.\nremote: Compressing objects: 100% (158/158), done.\nremote: Total 263 (delta 141), reused 216 (delta 100), pack-reused 0\nReceiving objects: 100% (263/263), 132.13 KiB | 782.00 KiB/s, done.\nResolving deltas: 100% (141/141), done.\n[eve@computer test]$ cd go-term-text/\n[eve@computer go-term-text]$ git config user.name \"eve\"\n[eve@computer go-term-text]$ git config user.email \"eve@example.org\"\n[eve@computer go-term-text]$ git bug bridge configure --name=github2 --target=github --token=$TOKEN --url=https://github.com/MichaelMure/go-term-text\nBuilding identity cache... Done.\nBuilding bug cache... Done.\nSuccessfully configured bridge: github2\n[eve@computer go-term-text]$ git bug bridge pull github2\nError: missing identity token\n[eve@computer go-term-text]$ git bug user create\nName [eve]: \nEmail [eve@example.org]: \nAvatar URL: \n\n605b22282a8abb56095422679affa4bf7872a98e\n[eve@computer go-term-text]$ git bug bridge pull github2\nError: missing identity token\n```\nThe same issue also happens when running `git bug bridge auth` afterwards:\nRepo from 1):\n```bash\n[eve@computer git-bug]$ git bug bridge auth \n51e8d3f github     token eve $TOKEN\n```\nRepo from 2):\n```bash\n[eve@computer go-term-text]$ git bug bridge auth\nError: identity doesn't exist\n```\n\nMy guess is that this is related to the credentials stored in the global `.gitconfig` file. After both bridges have been configured, there is only a single auth block (ids shortended as I don't know whether they leak information):\n```bash\n[git-bug \"auth.51e8d...\"]\n\tkind = token\n\tuserid = a66bcfdac7e2687ddb9310fc27bd011a5b8e334d\n\ttarget = github\n\tcreatetime = 1578397411\n\tvalue = $TOKEN\n```\nAs you can see, it maps to the userid of the user created in 1). If I edit userid to the userid from step 2 (so 605b22282a8abb56095422679affa4bf7872a98e) I can query auth (`git bug bridge auth`) pull (`git bug bridge pull githubX`) in the repo from 2), but not anymore in the one from 1).\n\nGenerally, it would be nice to have a general bridge configuration that is usable from all my repositories and not bound to an individual (repository-local) identity. So I'd rather have a bridge \"github\" with token from my account that I can use with all my repositories on github.\nIf multiaccount-usage is required, the user could then create an \"github-account2\" bridge...\n\nThank you for this software and reading thus far in this bug report :) I hope this information is more-or-less complete and sufficient, but feel free to ping me if you need more information/a tester.\n\nBest regards,\nSimon\n\n# Useful information:\n- git-bug version  0.6.0.r3.gca1d305-1, revision ca1d305308d4ee6d0fec16a0af10b62bb52cd265 build from git\n- go version go1.13.5 linux/amd64\n- git version 2.24.1","files":null}]}