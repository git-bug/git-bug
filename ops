{"author":{"id":"603472e3a86fab31c54777a9a2f5c5224da3b77b7103312c5af0680960e61c08"},"ops":[{"type":1,"timestamp":1698123234,"nonce":"dcCf+JG6dkXILAOoZVhhpbFnNDQ=","metadata":{"github-id":"I_kwDOCGKeh850vJz8","github-url":"https://github.com/git-bug/git-bug/issues/1129","origin":"github"},"title":"util/text/validate.go: Safe is not safe","message":"https://github.com/MichaelMure/git-bug/blob/1212f755a0df22f69e201912390ea9f710ccbf1f/util/text/validate.go#L19-L34\n\ndoesn't check for invalid UTF-8, so this string would be returned as safe:\n\n~~~\n\"\\xA0\\xA1\"\n~~~\n\nalso doesn't catch all control characters, so this would also be returned as safe:\n\n~~~\n\"\\u200E\"\n~~~\n\nimproved code:\n\n~~~go\npackage unicode\n\nimport (\n   \"unicode\"\n   \"unicode/utf8\"\n)\n\nfunc binary(src []byte) bool {\n   for len(src) \u003e= 1 {\n      r, size := utf8.DecodeRune(src)\n      if r == utf8.RuneError {\n         if size == 1 {\n            return true\n         }\n      }\n      if unicode.Is(unicode.C, r) {\n         return true\n      }\n      src = src[size:]\n   }\n   return false\n}\n~~~","files":null}]}